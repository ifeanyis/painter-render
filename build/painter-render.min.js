/*!
*  @license painter-render v0.0.1next
* (c) 2019 yelloxing git+https://github.com/yelloxing/painter-render.git
* License: MIT
*/

!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t():e.painterRender=t()}("undefined"!=typeof window?window:this,function(e){"use strict";var c=function(e){return e&&e.constructor===CanvasRenderingContext2D?e:e&&e.getContext("2d")};return function(e){var t=function(){};return t.layer=function(e,a,i){var n,r,t=c(e);"number"!=typeof a&&(a=e.clientWidth),"number"!=typeof i&&(i=e.clientHeight);var o={},u={add:function(e){if(o[e])throw new Error("Layer ["+e+"] already exists!");var t={canvas:document.createElement("canvas"),pre:null,next:null,eyeable:!0};return t.canvas.setAttribute("width",a),t.canvas.setAttribute("height",i),t.painter=c(t.canvas),o[e]=t,n||r?(o[e].pre=r,o[r].next=e,r=e):n=r=e,u},see:function(e){return o[e]||{top:r,bottom:n,layers:o}},delete:function(e){var t=o[e];return t&&(r==e&&(r=t.pre),n==e&&(n=t.next),null!=t.pre&&(o[t.pre].next=t.next),null!=t.next&&(o[t.next].pre=t.pre)),delete o[e],u},togger:function(e,t){var n=o[e];return n&&(n.eyeable="boolean"==typeof t?t:!n.eyeable),u},draw:function(e,t,n){e.x=e.x||0,e.y=e.y||0,t.x=t.x||0,t.y=t.y||0,e.width=e.width||a,e.height=e.height||i,t.width=t.width||a,t.height=t.height||i;var r=o[t.id];return o[e.id]&&r&&(r.painter.save(),r.painter.drawImage(o[e.id].canvas,e.x,e.y,e.width,e.height,t.x,t.y,t.width,t.height),r.painter.restore()),u},update:function(){var e=n;for(t.clearRect(0,0,a,i);null!=e;)o[e].eyeable&&t.drawImage(o[e].canvas,0,0,a,i,0,0,a,i),e=o[e].next;return u}};return u}(e),t}});